{"version":3,"sources":["scripts.min.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","ajax","path","Promise","resolve","reject","xmlhttp","XMLHttpRequest","onreadystatechange","readyState","status","responseText","open","send","loadTemplate","viewGroup","templatePath","promise","then","data","innerHTML","err","msg","alert","window","document","events","models","controllers","views","controllerInterface","model","controller","view","modelFactory","prop","./controllers","./models","./pubsub","./views","2","Object","create","3","getCountServer","this","JSON","parse","count","4","title","details","info","footer","./detailsController","./footerController","./infoController","./titleController","5","getInfo","6","getFoxes","foxes","forEach","fox","display","getTitle","index","getNextFox","indexVal","parseInt","isNaN","id","name","imgUrl","facts","sound","7","imgPath","soundPath","dataFile","result","countServer","host","url","console","log","8","on","eventName","func","push","off","filter","handler","emit","9","onTemplateLoaded","root","nameView","$","imgView","factsView","backButton","soundButton","pause","currFox","addClass","setAttribute","removeClass","addEventListener","paused","Audio","play","getElementById","10","countView","11","./details","./footer","./info","./title","12","listView","fact","children","text","cloneNode","appendChild","popover","imgCaption","13","imgGroupView","titleView","child","img","initImg","getAttribute","getFox","$img","dfd","Deferred","fadeOut","fadeIn"],"mappings":"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","file":"../scripts.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function(window, document) {\n  var events = require(\"./pubsub\")(),\n      models = require(\"./models\"),\n      controllers = require(\"./controllers\"),\n      views = require(\"./views\");\n\n  var controllerInterface = {\n    events: events,\n    ajax: ajax,\n    loadTemplate: loadTemplate\n  };\n\n  (function init() {\n    var model, controller, view;\n\n    models.modelFactory(controllerInterface)\n      .then(function success(data) {\n        model = data;\n\n        for (var prop in controllers) {\n          controller = controllers[prop](controllerInterface, model);\n          view = views[prop](controller);\n        }\n      }, function error(err) {\n        alert(err);\n\n      });\n  })();\n})(window, document);\n\nfunction ajax(path) {\n  return new Promise(function(resolve, reject) {\n    var xmlhttp = new XMLHttpRequest();\n \n    xmlhttp.onreadystatechange = function() {\n      if (xmlhttp.readyState == 4) {\n        if (xmlhttp.status == 200)\n          resolve(xmlhttp.responseText);\n        else\n          reject(xmlhttp.status);\n      }\n    }\n\n    xmlhttp.open(\"GET\", path);\n    xmlhttp.send();\n  });\n}\n\nfunction loadTemplate(viewGroup, templatePath) {\n  var promise = ajax(templatePath);\n\n  return promise.then(function success(data) {\n    viewGroup.innerHTML = data;\n    return viewGroup;\n\n  }, function error(err) {\n    var msg = \"Failed to load template!\";\n    viewGroup.innerHTML = msg;\n    alert(\"Status: \" + err + \"! \" + msg);\n  });\n}\n\n},{\"./controllers\":4,\"./models\":7,\"./pubsub\":8,\"./views\":11}],2:[function(require,module,exports){\nmodule.exports = function(controllerInterface, model) {\n  var controller = Object.create(controllerInterface);\n  return controller;\n};\n\n},{}],3:[function(require,module,exports){\nmodule.exports = function(controllerInterface, model) {\n  var controller = Object.create(controllerInterface);\n\n  controller.getCountServer = function() {\n    return this.ajax(model.getCountServer()).then(\n      function success(data) {\n        data = JSON.parse(data);\n        return data.count;\n  \n      }, function error(err) {\n        throw new Error(\"Could not retrieve views count!\");\n      });\n  };\n\n  return controller;\n};\n\n},{}],4:[function(require,module,exports){\nexports.title = require(\"./titleController\");\n\nexports.details = require(\"./detailsController\");\n\nexports.info = require(\"./infoController\");\n\nexports.footer = require(\"./footerController\");\n\n},{\"./detailsController\":2,\"./footerController\":3,\"./infoController\":5,\"./titleController\":6}],5:[function(require,module,exports){\nmodule.exports = function(controllerInterface, model) {\n  var controller = Object.create(controllerInterface);\n\n  controller.getInfo = function getInfo() {\n    return model.getInfo();\n  };\n\n  return controller;\n};\n\n},{}],6:[function(require,module,exports){\nmodule.exports = function(controllerInterface, model) {\n  var controller = Object.create(controllerInterface);\n  var foxes;\n\n  function getFoxes() {\n    foxes = model.getFoxes();\n    foxes.forEach(function (fox) {\n      fox.display = false;\n    });\n  }\n\n  controller.getTitle = function getTitle() {\n    return model.getTitle();\n  };\n\n  var index = 0;\n  controller.getNextFox = function getNextFox(i) {\n    var indexVal = parseInt(i);\n    if (!isNaN(indexVal)) {\n      foxes[indexVal].display = false;\n      index = (indexVal + 1) % foxes.length;\n    }\n\n    var fox, id;\n    do {\n      fox = foxes[index];\n      id = index;\n      index = (index + 1) % foxes.length;\n    } while (fox.display);\n\n    fox.display = true;\n    return {\n      name: fox.name,\n      imgUrl: fox.imgUrl,\n      facts: fox.facts,\n      sound: fox.sound,\n      id: id \n    };\n  };\n\n  // Initialization of this instance\n  (function init() {\n    getFoxes();\n  })();\n  return controller;\n}\n\n},{}],7:[function(require,module,exports){\nexports.modelFactory = function(controller) {\n  var imgPath = \"static/img/\";\n  var soundPath = \"static/sounds/\";\n  var dataFile = \"static/data.json\";\n  var data;\n\n  return controller.ajax(dataFile).then(function success(result) {\n      data = JSON.parse(result);\n      data.foxes.forEach(function(fox) {\n        fox.imgUrl = imgPath + fox.imgUrl;\n        fox.sound = soundPath + fox.sound;\n      });\n\n      data.info.imgUrl = imgPath + data.info.imgUrl;\n\n      return {\n        getTitle: function getTitle() {\n          return data.title;\n        },\n        getFoxes: function getFoxes() {\n          return data.foxes;\n          //return foxes;\n        },\n        getInfo: function getInfo() {\n          return data.info;\n        },\n        getCountServer: function getCountServer() {\n          return data.countServer.host + data.countServer.url;\n        }\n      };\n\n    }, function error(err) {\n      var msg = \"Failed to Retrieve Data from json!\";\n      console.log(msg);\n\n      throw new Error(msg);\n    });\n};\n\n},{}],8:[function(require,module,exports){\nmodule.exports = function() {\n  var events = {};\n\n  return {\n    on: function on(eventName, func) {\n      events[eventName] = events[eventName] || [];\n      events[eventName].push(func);\n    },\n    off: function off(eventName, func) {\n      if (events[eventName]) {\n        events[eventName] = events[eventName].filter(function(handler) {\n          return !(func === handler);\n        })\n      }\n    },\n    emit: function emit(eventName, data) {\n      if (events[eventName]) {\n        events[eventName].forEach(function(handler) {\n          handler(data);\n        });\n      }\n    }\n  };\n};\n\n},{}],9:[function(require,module,exports){\nmodule.exports = function(controller) {\n  var id = \"view-details\";\n  var viewGroup, nameView, imgView, factsView, backButton, soundButton;\n  var currFox;\n  var sound;\n  \n  function onTemplateLoaded(root) {\n    nameView = $(\"#\" + id + \"-name\")[0];\n    imgView = $(\"#\" + id + \"-img-view\")[0];\n    factsView = $(\"#\" + id + \"-facts-body\")[0];\n    backButton = $(\"#\" + id + \"-back-button\")[0];\n    soundButton = $(\"#\" + id + \"-sound-button\")[0];\n\n    controller.events.on(\"title-picture-clicked\", function(fox) {\n      if (sound)\n        sound.pause();\n\n      currFox = fox;\n      $(viewGroup).addClass(\"view-details-show\");\n\n      nameView.innerHTML = fox.name;\n      imgView.setAttribute(\"src\", fox.imgUrl);\n      factsView.innerHTML = fox.facts;\n\n    }); \n\n    controller.events.on(\"details-closed\", function() {\n      if (sound)\n        sound.pause();\n\n      $(viewGroup).removeClass(\"view-details-show\");\n    });\n\n    soundButton.addEventListener(\"click\", function() {\n      if (!sound || sound.paused) {\n        sound = new Audio(currFox.sound);\n        sound.play();\n      }\n    });\n\n    backButton.addEventListener(\"click\", function() {\n      controller.events.emit(\"details-closed\");\n    });\n  }\n\n  (function init() {\n    viewGroup = document.getElementById(id);\n    controller.loadTemplate(viewGroup, \"app/views/details/details.html\")\n      .then(onTemplateLoaded);\n  })();\n  return this;\n};\n\n},{}],10:[function(require,module,exports){\nmodule.exports = function(controller) {\n  var id = \"view-footer\";\n  var viewGroup, countView\n\n  function onTemplateLoaded(root) {\n    countView = $(\"#\" + id + \"-visits-count\")[0];\n\n    controller.getCountServer()\n      .then(function success(count) {\n        countView.innerHTML = count;\n  \n      }, function error(err) {\n        countView.innerHTML = \"n/a\";\n   \n      });\n  }\n\n  (function init() {\n    viewGroup = document.getElementById(id);\n    controller.loadTemplate(viewGroup, \"app/views/footer/footer.html\")\n      .then(onTemplateLoaded);\n  })();\n  return this;\n}\n\n\n},{}],11:[function(require,module,exports){\nexports.title = require(\"./title\");\n\nexports.details = require(\"./details\");\n\nexports.info = require(\"./info\");\n\nexports.footer = require(\"./footer\");\n\n},{\"./details\":9,\"./footer\":10,\"./info\":12,\"./title\":13}],12:[function(require,module,exports){\nmodule.exports = function(controller) {\n  var id = \"view-info\";\n  var viewGroup, listView, imgView;\n\n  var info;\n  function onTemplateLoaded(root) {\n    listView = $(\"#\" + id + \"-list\")[0];\n    imgView = $(\"#\" + id + \"-img\")[0];\n    info = controller.getInfo();\n\n    info.facts.forEach(function(fact, i) {\n      var a = listView.children[0];\n      var text = a.innerHTML;\n      if (i > 0) {\n        a = a.cloneNode();\n        a.innerHTML = text;\n        listView.appendChild(a);\n      }\n      a.setAttribute(\"data-content\", fact); \n      $(a).popover();\n    });\n\n    imgView.setAttribute(\"src\", info.imgUrl);\n    imgView.setAttribute(\"title\", info.imgCaption);\n\n    controller.events.on(\"title-picture-clicked\", function(fox) {\n      $(viewGroup).addClass(\"view-info-hide\");\n    });\n\n    controller.events.on(\"details-closed\", function() {\n      $(viewGroup).removeClass(\"view-info-hide\");\n    });\n  }\n\n  (function init() {\n    viewGroup = document.getElementById(id);\n    controller.loadTemplate(viewGroup, \"app/views/info/info.html\")\n      .then(onTemplateLoaded);\n  })();\n  return this;\n};\n\n},{}],13:[function(require,module,exports){\nmodule.exports = function(controller) {\n  var id = \"view-title\";\n  var viewGroup;\n  \n  function onTemplateLoaded(root) {\n    var imgGroupView, titleView;\n  \n    for (var i = 0; i < root.children.length; ++i) {\n      child = root.children[i];\n      switch(child.id) {\n        case \"img-group\":\n          imgGroupView = child;\n          break;\n  \n        case \"title\":\n          titleView = child;\n          break;\n\n        default:\n          // Default\n      }\n    }\n    titleView.innerHTML = controller.getTitle();\n    for (var i = 0; i < imgGroupView.children.length; ++i) {\n      var img = imgGroupView.children[i]; \n      (function(img) {\n        initImg(img, function() {\n          return controller.getNextFox(img.getAttribute(\"fox-id\"));\n        });\n      })(img);\n    }\n  }\n\n  function initImg(img, getFox) {\n    var fox = getFox();\n    img.setAttribute(\"src\", fox.imgUrl);\n    img.setAttribute(\"fox-id\", fox.id);\n  \n    var $img = $(img);\n    $img.on(\"click\", function() {\n      var dfd = $.Deferred();\n\n      $(this).fadeOut(500, function() {\n        controller.events.emit(\"title-picture-clicked\", fox);\n        dfd.resolve();\n      });\n\n      dfd.then(function success() {\n        fox = getFox();\n        img.setAttribute(\"src\", fox.imgUrl);\n        img.setAttribute(\"fox-id\", fox.id);\n        $img.fadeIn(500);            \n      })\n    })\n  }\n\n  (function init() {\n    viewGroup = document.getElementById(id);\n    controller.loadTemplate(viewGroup, \"app/views/title/title.html\")\n      .then(onTemplateLoaded);\n  })();\n  \n  return this;\n};\n\n},{}]},{},[1]);\n"]}